<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>مسير الراتب والاحتياجات</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="style.css">
    <script type="importmap">
    {
      "imports": {
        "lucide": "https://esm.sh/lucide@0.444.0"
      }
    }
    </script>
</head>
<body class="bg-[#F1F5F9] text-slate-800 font-sans h-screen flex flex-col overflow-hidden items-center justify-start">
    <div id="main-app-container" class="w-full max-w-2xl h-full bg-[#F8FAFC] flex flex-col overflow-hidden shadow-2xl relative transition-all duration-500">
    <!-- Header / Salary Status -->
    <header class="header-gradient text-white pt-4 sm:pt-6 pb-8 sm:pb-12 px-4 sm:px-6 shadow-2xl flex-shrink-0 relative z-30 rounded-b-[2rem] sm:rounded-b-[3.5rem]">
        <!-- Decorative subtle pattern overlay -->
        <div class="absolute inset-0 opacity-10 pointer-events-none overflow-hidden rounded-b-[2rem] sm:rounded-b-[3.5rem]">
            <svg class="absolute w-full h-full" viewBox="0 0 100 100" preserveAspectRatio="none">
                <defs><pattern id="dots" x="0" y="0" width="10" height="10" patternUnits="userSpaceOnUse"><circle cx="2" cy="2" r="1" fill="currentColor"/></pattern></defs>
                <rect width="100" height="100" fill="url(#dots)"/>
            </svg>
        </div>

        <div class="flex justify-between items-center mb-6 relative z-10">
            <div class="flex items-center gap-3">
                <div class="bg-white/20 p-2.5 rounded-xl backdrop-blur-xl border border-white/30 shadow-lg">
                    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><rect width="20" height="14" x="2" y="5" rx="2"/><line x1="2" x2="22" y1="10" y2="10"/></svg>
                </div>
                <div>
                    <h1 class="text-xl font-black tracking-tight leading-none">مسير الراتب</h1>
                    <p class="text-[9px] text-white/60 font-medium uppercase tracking-[0.2em] mt-1">Smart Wallet Manager</p>
                </div>
            </div>
            <div class="flex gap-2.5">
                <button id="end-month-btn" class="bg-emerald-500 hover:bg-emerald-400 text-white text-[10px] font-bold px-4 py-2 rounded-xl transition-all shadow-lg shadow-emerald-900/20 active:scale-95">نهاية الشهر</button>
                <button id="reset-btn" class="bg-white/10 hover:bg-white/20 text-white text-[10px] font-bold px-4 py-2 rounded-xl backdrop-blur-sm transition-all border border-white/20 active:scale-95">تصفير</button>
            </div>
        </div>
        
        <div class="grid grid-cols-2 gap-4 relative z-10">
            <div id="income-trigger" class="glass-card p-4 rounded-3xl cursor-pointer transition-all active:scale-95 group relative overflow-hidden shadow-2xl">
                <div class="absolute -right-6 -top-6 w-20 h-20 bg-white/10 rounded-full blur-2xl group-hover:scale-150 transition-transform duration-700"></div>
                
                <div class="relative z-10 h-full flex flex-col justify-between">
                    <div class="flex justify-between items-start mb-2">
                        <p class="text-[10px] font-black text-white/80 uppercase tracking-widest">الميزانية الإجمالية</p>
                        <div class="bg-white/20 p-1.5 rounded-xl text-white shadow-sm border border-white/20 group-hover:bg-white/40 transition-colors">
                            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M12 5v14M5 12h14"/></svg>
                        </div>
                    </div>
                    <div class="flex items-baseline gap-1.5">
                        <span id="total-budget" class="text-2xl sm:text-3xl font-black text-white tracking-tighter">46,000</span>
                        <span class="text-[11px] text-white/60 font-bold">دج</span>
                    </div>
                </div>
            </div>
            
            <div id="balance-card" class="bg-emerald-500 p-4 rounded-3xl shadow-xl shadow-emerald-900/20 transition-all duration-500 border border-white/20 flex flex-col justify-between relative overflow-hidden group active:scale-95 cursor-pointer">
                <div class="relative z-10">
                    <div class="flex justify-between items-center mb-2">
                        <p class="text-[10px] font-black text-white/90 uppercase tracking-widest">الرصيد المتبقي</p>
                        <span id="balance-percent" class="text-[10px] font-black bg-white/20 px-2 py-0.5 rounded-lg border border-white/10">100%</span>
                    </div>
                    <div class="flex items-baseline gap-1.5">
                        <span id="balance" class="text-2xl sm:text-3xl font-black text-white tracking-tighter">46,000</span>
                        <span class="text-[11px] text-white/80 font-bold">دج</span>
                    </div>
                </div>
                <div class="w-full bg-black/10 h-2 rounded-full mt-4 overflow-hidden relative z-10 border border-white/10 shadow-inner">
                    <div id="balance-progress" class="bg-white h-full transition-all duration-1000 ease-out shadow-[0_0_12px_rgba(255,255,255,0.9)]" style="width: 100%"></div>
                </div>
                <div class="absolute -right-6 -bottom-6 w-24 h-24 bg-white/20 rounded-full blur-3xl group-hover:scale-150 transition-transform duration-1000"></div>
            </div>
        </div>

        <div class="mt-4 flex justify-between items-center px-2">
            <div class="flex gap-4">
                <div class="flex flex-col">
                    <span class="text-[9px] opacity-60 uppercase tracking-wider">الراتب الثابت</span>
                    <span class="text-xs font-semibold opacity-90">46,000 دج</span>
                </div>
                <div class="flex flex-col border-r border-white/20 pr-4">
                    <span class="text-[9px] opacity-60 uppercase tracking-wider">المصاريف</span>
                    <span id="total-spent" class="text-xs font-semibold text-indigo-100">0 دج</span>
                </div>
            </div>
        </div>


    </header>

    <!-- Main Navigation Tabs -->
    <div class="flex bg-white/90 backdrop-blur-2xl px-2 py-2 mt-[-1.5rem] mx-6 sm:mx-12 rounded-[2rem] shadow-2xl shadow-indigo-900/10 border border-white/50 z-40 flex-shrink-0 relative">
        <button id="tab-inventory" class="flex-1 py-3.5 text-center font-black text-xs sm:text-sm transition-all rounded-2xl relative overflow-hidden group active:scale-95">
            <span class="relative z-10">المتجر</span>
            <div id="tab-indicator-inventory" class="absolute inset-0 bg-indigo-50 rounded-2xl -z-10 scale-95 opacity-0 group-[.active]:opacity-100 group-[.active]:scale-100 transition-all duration-300"></div>
        </button>
        <button id="tab-cart" class="flex-1 py-3.5 text-center font-black text-xs sm:text-sm transition-all rounded-2xl text-slate-400 flex justify-center items-center gap-2 group active:scale-95">
            <span class="relative z-10">قائمة التسوق</span>
            <span id="cart-count" class="bg-indigo-600 text-white px-2.5 py-0.5 rounded-lg text-[10px] font-black shadow-lg shadow-indigo-600/20">0</span>
            <div id="tab-indicator-cart" class="absolute inset-0 bg-indigo-50 rounded-2xl -z-10 scale-95 opacity-0 group-[.active]:opacity-100 group-[.active]:scale-100 transition-all duration-300"></div>
        </button>
    </div>

    <!-- Content Area -->
    <main class="flex-1 overflow-hidden relative">
        <!-- Home Dashboard Empty State -->
        <div class="h-full flex flex-col items-center justify-center p-8 text-center opacity-40">
            <div class="w-20 h-20 bg-indigo-100 text-indigo-600 rounded-[2rem] flex items-center justify-center mb-6 shadow-inner">
                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9h18v10a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V9Z"/><path d="m3 9 2.45-4.91A2 2 0 0 1 7.24 3h9.52a2 2 0 0 1 1.79 1.09L21 9"/></svg>
            </div>
            <h2 class="text-lg font-black text-slate-800 mb-2">مرحباً بك في مسير الراتب</h2>
            <p class="text-xs font-bold text-slate-500 max-w-[200px] leading-relaxed">ابدأ بتنظيم مشترياتك الشهرية من خلال المتجر أو عرض قائمتك الحالية</p>
        </div>

        <!-- Store / Inventory View (New Window) -->
        <section id="view-inventory" class="fixed inset-0 bg-[#F1F5F9] z-[90] flex flex-col transition-all duration-500 translate-y-full opacity-0 pointer-events-none">
            <!-- Header for the Store Window -->
            <div class="header-gradient p-6 pb-10 rounded-b-[3rem] shadow-xl relative overflow-hidden flex-shrink-0">
                <div class="absolute inset-0 opacity-10 pointer-events-none">
                    <svg class="w-full h-full" viewBox="0 0 100 100" preserveAspectRatio="none">
                        <pattern id="store-dots" x="0" y="0" width="10" height="10" patternUnits="userSpaceOnUse"><circle cx="2" cy="2" r="1" fill="white"/></pattern>
                        <rect width="100" height="100" fill="url(#store-dots)"/>
                    </svg>
                </div>
                <div class="flex justify-between items-center relative z-10">
                    <button id="close-inventory" class="bg-white/20 p-3 rounded-2xl backdrop-blur-md border border-white/30 text-white active:scale-90 transition-transform">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="m15 18-6-6 6-6"/></svg>
                    </button>
                    <div class="text-center flex-1">
                        <h2 class="text-xl font-black text-white">متجر المواد</h2>
                        <p class="text-[10px] text-white/60 font-bold uppercase tracking-widest mt-1">Select items to buy</p>
                    </div>
                    <button id="add-custom-trigger-header" class="bg-emerald-400 text-white p-3 rounded-2xl shadow-lg shadow-emerald-900/20 active:scale-90 transition-transform">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14m-7-7v14"/></svg>
                    </button>
                </div>
            </div>

            <div class="flex-1 overflow-hidden relative mt-[-2rem] px-4 flex flex-col">
                <!-- Search Bar -->
                <div class="bg-white rounded-2xl shadow-lg border border-indigo-50 p-2 mb-4 flex gap-2 items-center z-20">
                    <div class="pr-3 text-slate-400">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>
                    </div>
                    <input type="text" id="search-input" placeholder="ابحث عن مادة..." class="flex-1 py-3 text-sm font-bold text-slate-700 focus:outline-none">
                </div>

                <div id="categories-container" class="flex-1 overflow-y-auto space-y-4 pb-28">
                    <!-- Categories will be injected here -->
                </div>
            </div>

            <!-- Bottom Floating Action -->
            <div id="store-footer-action" class="absolute bottom-6 left-6 right-6 bg-white rounded-3xl p-5 shadow-2xl border border-indigo-50 flex justify-between items-center z-20">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 rounded-full bg-indigo-50 text-indigo-600 flex items-center justify-center">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="8" cy="21" r="1"/><circle cx="19" cy="21" r="1"/><path d="M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12"/></svg>
                    </div>
                    <div>
                        <p class="text-[10px] text-slate-400 font-bold uppercase">قائمة التسوق</p>
                        <p class="text-xs font-black text-slate-700"><span id="store-cart-count">0</span> مواد مختارة</p>
                    </div>
                </div>
                <button id="view-cart-from-store" class="bg-indigo-600 text-white px-8 py-3.5 rounded-2xl font-black text-sm shadow-lg shadow-indigo-200 active:scale-95 transition-all">فتح القائمة</button>
            </div>
        </section>

        <!-- Cart View (Styled as a New Window/Overlay) -->
        <section id="view-cart" class="fixed inset-0 bg-[#F1F5F9] z-[100] flex flex-col transition-all duration-500 translate-y-full opacity-0 pointer-events-none">
            <!-- Header for the "New Window" -->
            <div class="header-gradient p-6 pb-10 rounded-b-[3rem] shadow-xl relative overflow-hidden flex-shrink-0">
                <div class="absolute inset-0 opacity-10 pointer-events-none">
                    <svg class="w-full h-full" viewBox="0 0 100 100" preserveAspectRatio="none">
                        <pattern id="cart-dots" x="0" y="0" width="10" height="10" patternUnits="userSpaceOnUse"><circle cx="2" cy="2" r="1" fill="white"/></pattern>
                        <rect width="100" height="100" fill="url(#cart-dots)"/>
                    </svg>
                </div>
                <div class="flex justify-between items-center relative z-10">
                    <button id="close-cart" class="bg-white/20 p-3 rounded-2xl backdrop-blur-md border border-white/30 text-white active:scale-90 transition-transform">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="m15 18-6-6 6-6"/></svg>
                    </button>
                    <div class="text-center flex-1">
                        <h2 class="text-xl font-black text-white">قائمة التسوق</h2>
                        <p class="text-[10px] text-white/60 font-bold uppercase tracking-widest mt-1">Review your items</p>
                    </div>
                    <button id="print-receipt-btn" class="bg-white/20 p-3 rounded-2xl backdrop-blur-md border border-white/30 text-white active:scale-90 transition-transform">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M6 9V2h12v7"/><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"/><rect width="12" height="8" x="6" y="14"/></svg>
                    </button>
                </div>
            </div>

            <div class="flex-1 overflow-hidden relative mt-[-2rem] px-4">
                <div id="cart-items" class="h-full overflow-y-auto space-y-2 pb-24 pt-4">
                    <!-- Cart items will be injected here -->
                    <div id="empty-cart-msg" class="text-center py-20 text-gray-400 italic">السلة فارغة حالياً</div>
                </div>
            </div>

            <!-- Bottom Floating Summary -->
            <div id="cart-footer-summary" class="absolute bottom-6 left-6 right-6 bg-white rounded-3xl p-5 shadow-2xl border border-indigo-50 flex justify-between items-center z-20 hidden">
                <div>
                    <p class="text-[10px] text-slate-400 font-bold uppercase mb-1">إجمالي السلة</p>
                    <div class="flex items-baseline gap-1">
                        <span id="footer-total-price" class="text-2xl font-black text-indigo-600">0</span>
                        <span class="text-xs font-bold text-indigo-400">دج</span>
                    </div>
                </div>
                <button id="cart-footer-close" class="bg-indigo-600 text-white px-8 py-3.5 rounded-2xl font-black text-sm shadow-lg shadow-indigo-200 active:scale-95 transition-all">العودة للمتجر</button>
            </div>
        </section>
    </main>

    <!-- App Footer -->
    <footer class="footer-container z-40 flex-shrink-0">
        <div class="footer-dock">
            <!-- Savings Vault Display (Compact Footer Version) -->
            <div id="savings-card" class="savings-widget group hidden">
                <div class="savings-icon-wrapper">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M20.91 8.84 8.56 2.23a1.93 1.93 0 0 0-1.81 0L3.1 4.13a2.12 2.12 0 0 0-.05 3.69l12.22 6.93a2 2 0 0 0 1.94 0L21 12.51a2.12 2.12 0 0 0-.09-3.67Z"/><path d="m3 8 8 4.5"/><path d="m11 12.5 8-4.5"/><path d="M11 12.5V21"/></svg>
                </div>
                <div class="flex flex-col">
                    <span class="widget-label">المدخرات الكلية</span>
                    <div class="flex items-center gap-2">
                        <div class="flex items-baseline gap-0.5" id="savings-value-container">
                            <span id="total-savings" class="text-base font-black text-slate-900 transition-all blur-md select-none">0</span>
                            <span class="text-[10px] text-emerald-600 font-bold">دج</span>
                        </div>
                        <div id="savings-toggle-icon" class="text-slate-400 group-hover:text-amber-500 transition-colors">
                            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0z"/><circle cx="12" cy="12" r="3"/></svg>
                        </div>
                    </div>
                </div>
            </div>

            <button id="logout-btn" class="logout-pill group">
                <span class="logout-label">تسجيل الخروج</span>
                <div class="logout-icon-wrapper">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" x2="9" y1="12" y2="12"/></svg>
                </div>
            </button>
        </div>
    </footer>

    </div>

    <!-- Modals (Moved outside main-app-container to maintain focus when background blurs) -->
    
    <!-- Price Modal -->
    <div id="price-modal" class="fixed inset-0 bg-slate-900/60 backdrop-blur-md hidden items-center justify-center p-6 z-[200]">
        <div class="bg-white w-full max-w-[340px] rounded-[2.5rem] p-8 shadow-[0_25px_50px_-12px_rgba(0,0,0,0.5)] animate-pop-in border border-white/20">
            <div class="text-center mb-6">
                <div class="w-14 h-14 bg-indigo-50 text-indigo-600 rounded-2xl flex items-center justify-center mx-auto mb-3 shadow-inner">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>
                </div>
                <h3 id="modal-title" class="text-lg font-black text-slate-800">تفاصيل المادة</h3>
            </div>
            
            <div class="space-y-4">
                <div class="relative">
                    <label class="absolute -top-2 right-4 bg-white px-2 text-[10px] font-bold text-slate-400 z-10">اسم المادة</label>
                    <input type="text" id="modal-item-name" class="w-full bg-slate-50 border-2 border-slate-100 p-3 rounded-xl text-sm font-bold text-slate-700 focus:border-indigo-500 focus:outline-none transition-all">
                </div>
                <div class="relative">
                    <label class="absolute -top-2 right-4 bg-white px-2 text-[10px] font-bold text-indigo-500 z-10">السعر (دج)</label>
                    <input type="number" id="modal-item-price" class="w-full bg-slate-50 border-2 border-slate-100 p-4 rounded-2xl text-2xl font-black text-slate-800 focus:border-indigo-500 focus:outline-none transition-all text-center" autofocus placeholder="0">
                </div>
                
                <div>
                    <label class="block text-center text-[10px] font-black text-slate-400 uppercase tracking-widest mb-3">اختر الأسبوع</label>
                    <div class="grid grid-cols-4 gap-2">
                        <button type="button" class="week-selector h-12 flex items-center justify-center rounded-xl text-sm font-black transition-all" data-week="1">1</button>
                        <button type="button" class="week-selector h-12 flex items-center justify-center rounded-xl text-sm font-black transition-all" data-week="2">2</button>
                        <button type="button" class="week-selector h-12 flex items-center justify-center rounded-xl text-sm font-black transition-all" data-week="3">3</button>
                        <button type="button" class="week-selector h-12 flex items-center justify-center rounded-xl text-sm font-black transition-all" data-week="4">4</button>
                    </div>
                </div>

                <div class="flex flex-col gap-2 pt-2">
                    <button id="modal-confirm" class="w-full py-4 bg-indigo-600 text-white rounded-2xl font-black text-sm shadow-lg shadow-indigo-200 active:scale-95 transition-all">تحديث البيانات</button>
                    <button id="modal-cancel" class="w-full py-3 text-slate-400 font-bold text-xs hover:text-slate-600 transition-colors">إلغاء</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Income Modal -->
    <div id="income-modal" class="fixed inset-0 bg-slate-900/60 backdrop-blur-md hidden items-center justify-center p-6 z-[210]">
        <div class="bg-white w-full max-w-[340px] rounded-[2.5rem] p-8 shadow-2xl animate-pop-in border border-white/20">
            <div class="text-center mb-6">
                <div class="w-14 h-14 bg-indigo-50 text-indigo-600 rounded-2xl flex items-center justify-center mx-auto mb-3 shadow-inner">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>
                </div>
                <h3 class="text-xl font-black text-slate-800">إضافة ميزانية</h3>
            </div>
            <div class="space-y-4">
                <div class="relative">
                    <label class="absolute -top-2 right-4 bg-white px-2 text-[10px] font-bold text-indigo-500 z-10">قيمة الدخل الإضافي (دج)</label>
                    <input type="number" id="extra-income-input" class="w-full bg-slate-50 border-2 border-slate-100 p-4 rounded-2xl text-2xl font-black text-slate-800 focus:border-indigo-500 focus:outline-none transition-all text-center" placeholder="0">
                </div>
                <div class="flex flex-col gap-2 pt-2">
                    <button id="income-confirm" class="w-full py-4 bg-indigo-600 text-white rounded-2xl font-black text-sm shadow-lg shadow-indigo-200 active:scale-95 transition-all">تحديث الميزانية</button>
                    <button id="income-cancel" class="w-full py-3 text-slate-400 font-bold text-xs hover:text-slate-600 transition-colors">إلغاء</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div id="confirm-modal" class="fixed inset-0 bg-slate-900/60 backdrop-blur-md hidden items-center justify-center p-6 z-[250]">
        <div class="bg-white w-full max-w-xs rounded-[2rem] p-8 shadow-2xl animate-scale-in text-center">
            <div class="w-16 h-16 bg-rose-50 text-rose-500 rounded-2xl flex items-center justify-center mx-auto mb-6 rotate-3">
                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"/><path d="M12 9v4"/><path d="M12 17h.01"/></svg>
            </div>
            <h3 id="confirm-modal-title" class="text-xl font-black mb-3 text-slate-800 tracking-tight">هل أنت متأكد؟</h3>
            <p id="confirm-modal-message" class="text-sm text-slate-500 leading-relaxed mb-8 px-2">سيؤدي هذا الإجراء إلى تغيير البيانات الحالية بشكل دائم.</p>
            <div class="flex flex-col gap-3">
                <button id="confirm-modal-ok" class="w-full py-4 bg-slate-900 text-white rounded-2xl font-bold hover:bg-black transition-all shadow-xl shadow-slate-200">نعم، متأكد</button>
                <button id="confirm-modal-cancel" class="w-full py-3 bg-white text-slate-400 rounded-xl font-bold hover:text-slate-600 transition-colors">تراجع</button>
            </div>
        </div>
    </div>

    <!-- Auth Modal -->
    <div id="auth-modal" class="fixed inset-0 bg-slate-900/80 backdrop-blur-xl flex items-center justify-center p-6 z-[300]">
        <div class="bg-white w-full max-w-[340px] rounded-[2.5rem] p-8 shadow-[0_30px_100px_-20px_rgba(0,0,0,0.8)] border border-white/40 relative overflow-hidden animate-pop-in">
            <!-- Subtle decorative element -->
            <div class="absolute -top-24 -right-24 w-48 h-48 bg-indigo-50 rounded-full blur-3xl opacity-30 pointer-events-none"></div>
            
            <div class="relative z-10">
                <div class="text-center mb-8">
                    <div class="w-16 h-16 bg-indigo-600 text-white rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-xl shadow-indigo-600/30 transform hover:rotate-6 transition-transform">
                        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10"/></svg>
                    </div>
                    <h2 class="text-2xl font-black text-slate-900 tracking-tight">تسجيل الدخول</h2>
                    <p class="text-[10px] text-slate-500 font-extrabold mt-2 uppercase tracking-[0.2em] opacity-80">نظام إدارة الميزانية الآمن</p>
                </div>
                
                <div class="space-y-6">
                    <div class="relative">
                        <label class="absolute -top-2 right-4 bg-white px-2 text-[10px] font-black text-indigo-600 z-10 uppercase tracking-tighter">اسم المستخدم</label>
                        <input type="text" id="auth-username" class="w-full bg-slate-50 border-2 border-slate-200 p-4 rounded-2xl text-sm font-bold text-slate-900 focus:border-indigo-600 focus:bg-white focus:outline-none transition-all placeholder-slate-400" placeholder="admin">
                    </div>
                    <div class="relative">
                        <label class="absolute -top-2 right-4 bg-white px-2 text-[10px] font-black text-indigo-600 z-10 uppercase tracking-tighter">كلمة المرور</label>
                        <input type="password" id="auth-password" class="w-full bg-slate-50 border-2 border-slate-200 p-4 rounded-2xl text-sm font-bold text-slate-900 focus:border-indigo-600 focus:bg-white focus:outline-none transition-all placeholder-slate-400" placeholder="••••••••">
                    </div>
                    
                    <div id="auth-error" class="text-rose-600 text-[10px] font-black text-center hidden bg-rose-50 py-3 rounded-xl border border-rose-200">بيانات الدخول غير صحيحة، حاول مرة أخرى</div>

                    <div class="pt-2">
                        <button id="auth-submit" class="w-full py-4.5 bg-indigo-600 text-white rounded-2xl font-black text-sm shadow-xl shadow-indigo-600/20 active:scale-95 transition-all hover:bg-indigo-700">دخول النظام</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Receipt Modal (Printable) -->
    <div id="receipt-modal" class="fixed inset-0 bg-slate-900/60 backdrop-blur-md hidden items-center justify-center p-4 sm:p-6 z-[400] overflow-y-auto">
        <div class="bg-white w-full max-w-xl rounded-[2.5rem] shadow-2xl relative my-auto animate-pop-in flex flex-col max-h-[90vh]">
            <!-- Header for Receipt -->
            <div class="p-6 border-b border-slate-100 flex justify-between items-center bg-slate-50 rounded-t-[2.5rem] no-print">
                <h3 class="font-black text-slate-800">وصل المشتريات الأسبوعي</h3>
                <div class="flex gap-2">
                    <button id="print-now-btn" class="bg-indigo-600 text-white px-5 py-2.5 rounded-xl font-bold text-xs flex items-center gap-2 shadow-lg shadow-indigo-200">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 6 2 18 2 18 9"/><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"/><rect width="12" height="8" x="6" y="14"/></svg>
                        طباعة
                    </button>
                    <button id="close-receipt-btn" class="p-2.5 text-slate-400 hover:text-slate-600 transition-colors">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
                    </button>
                </div>
            </div>

            <!-- Receipt Content -->
            <div id="receipt-content" class="p-8 overflow-y-auto flex-1 bg-white font-mono text-slate-900">
                <div class="text-center mb-8">
                    <h2 class="text-2xl font-black mb-1">مسير الراتب</h2>
                    <p class="text-xs text-slate-500 font-bold uppercase tracking-widest">Smart Wallet Manager</p>
                    <div class="my-4 border-b-2 border-dashed border-slate-200"></div>
                    <p class="text-[10px] font-bold text-slate-400" id="receipt-date"></p>
                </div>

                <div id="receipt-weeks-container" class="space-y-8">
                    <!-- Week sections injected here -->
                </div>

                <div class="mt-10 pt-6 border-t-2 border-dashed border-slate-200">
                    <div class="flex justify-between items-center mb-2">
                        <span class="font-black text-slate-500">إجمالي الميزانية</span>
                        <span class="font-black text-slate-800" id="receipt-total-budget">0 دج</span>
                    </div>
                    <div class="flex justify-between items-center mb-2">
                        <span class="font-black text-slate-500">مجموع المشتريات</span>
                        <span class="font-black text-slate-800" id="receipt-total-spent">0 دج</span>
                    </div>
                    <div class="flex justify-between items-center pt-2 mt-2 border-t border-slate-100">
                        <span class="text-lg font-black text-indigo-600">الرصيد المتبقي</span>
                        <span class="text-lg font-black text-indigo-600" id="receipt-total-balance">0 دج</span>
                    </div>
                </div>
                
                <div class="mt-10 text-center">
                    <p class="text-[10px] font-bold text-slate-400 italic">شكراً لاستخدامك مسير الراتب الذكي</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Add New Item Modal -->
    <div id="new-item-modal" class="fixed inset-0 bg-slate-900/60 backdrop-blur-md hidden items-center justify-center p-6 z-[210]">
        <div class="bg-white w-full max-w-[360px] rounded-[2.5rem] p-8 shadow-[0_25px_50px_-12px_rgba(0,0,0,0.5)] animate-pop-in border border-white/20">
            <div class="text-center mb-6">
                <div class="w-14 h-14 bg-emerald-50 text-emerald-600 rounded-2xl flex items-center justify-center mx-auto mb-3 shadow-inner">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14m-7-7v14"/></svg>
                </div>
                <h3 id="new-item-modal-title" class="text-xl font-black text-slate-800">إضافة مادة جديدة</h3>
            </div>
            
            <div class="space-y-5">
                <div class="relative">
                    <label class="absolute -top-2 right-4 bg-white px-2 text-[10px] font-bold text-slate-400 z-10">اسم المادة</label>
                    <input type="text" id="new-item-name" class="w-full bg-slate-50 border-2 border-slate-100 p-4 rounded-2xl text-sm font-bold text-slate-700 focus:border-indigo-500 focus:outline-none transition-all" placeholder="مثلاً: تفاح، حليب...">
                </div>

                <div class="relative">
                    <label class="absolute -top-2 right-4 bg-white px-2 text-[10px] font-bold text-slate-400 z-10">الفئة / التصنيف</label>
                    <select id="new-item-category" class="w-full bg-slate-50 border-2 border-slate-100 p-4 rounded-2xl text-sm font-bold text-slate-700 focus:border-indigo-500 focus:outline-none transition-all appearance-none">
                        <!-- Categories populated via JS -->
                    </select>
                </div>

                <div class="relative">
                    <label class="absolute -top-2 right-4 bg-white px-2 text-[10px] font-bold text-emerald-500 z-10">السعر (اختياري)</label>
                    <input type="number" id="new-item-price" class="w-full bg-slate-50 border-2 border-slate-100 p-4 rounded-2xl text-xl font-black text-slate-800 focus:border-emerald-500 focus:outline-none transition-all text-center" placeholder="0">
                </div>
                
                <div class="flex flex-col gap-2 pt-2">
                    <button id="new-item-confirm" class="w-full py-4 bg-indigo-600 text-white rounded-2xl font-black text-sm shadow-lg shadow-indigo-200 active:scale-95 transition-all">حفظ المادة</button>
                    <button id="new-item-cancel" class="w-full py-3 text-slate-400 font-bold text-xs hover:text-slate-600 transition-colors">إلغاء</button>
                </div>
            </div>
        </div>
    </div>
    <script type="module" src="app.js"></script>
</body>
</html>